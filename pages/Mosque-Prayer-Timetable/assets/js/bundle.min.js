/**
 * Vanilla Javascript Sticky Table v1.0.4
 * https://zhitkovkostya.github.io/sticky-table
 */

!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).StickyTable=t()}(this,function(){"use strict";return class{constructor(e){this.originalTableElement=e,this.wrapperElement=this._wrapTable(),this.originalTableWrapperElement=this._wrapTableBody(),this.fixedTableWrapperElement=this._wrapTableHead(),this.fixedTableElement=this.fixedTableWrapperElement.querySelector("table"),this.scrollLeft=this.originalTableElement.scrollLeft,this._handleWindowScrollThrottled=this._throttle(this._handleWindowScroll.bind(this),20),this._handleWindowResizeThrottled=this._throttle(this._handleWindowResize.bind(this),20),this._handleFixedTableWrapperScrollThrottled=this._throttle(this._handleFixedTableWrapperScroll.bind(this),20),this._handleOriginalTableWrapperScrollThrottled=this._throttle(this._handleOriginalTableWrapperScroll.bind(this),20),this._syncColumnWidth(),this._syncHeadPosition(),this.fixedTableWrapperElement.addEventListener("scroll",this._handleFixedTableWrapperScrollThrottled,!1),this.originalTableWrapperElement.addEventListener("scroll",this._handleOriginalTableWrapperScrollThrottled,!1),window.addEventListener("scroll",this._handleWindowScrollThrottled,!1),window.addEventListener("resize",this._handleWindowResizeThrottled)}_wrapTable(){const e=document.createElement("div");return e.className="js-table-wrapper",this.originalTableElement&&this.originalTableElement.parentNode&&(this.originalTableElement.parentNode.insertBefore(e,this.originalTableElement),e.appendChild(this.originalTableElement)),e}_wrapTableHead(){const e=this.originalTableElement?this.originalTableElement.tHead:null;if(!e)throw new Error("<thead> is missing");var t=e.cloneNode(!0);const l=document.createElement("div");var i=document.createElement("table");return this._toggleHeadVisibility(e,!1),l.className="js-table-head-wrapper",l.dataset.isFixed="false",l.style.overflowX="auto",l.ariaHidden="true",l.appendChild(i).appendChild(t),this.wrapperElement&&this.originalTableWrapperElement&&this.wrapperElement.insertBefore(l,this.originalTableWrapperElement),l}_wrapTableBody(){const e=document.createElement("div");return e.className="js-table-body-wrapper",e.style.overflowX="auto",this.originalTableElement&&this.wrapperElement&&(this.wrapperElement.insertBefore(e,this.originalTableElement),e.appendChild(this.originalTableElement)),e}_syncColumnWidth(){var t=this.fixedTableElement,e=this.originalTableElement;if(t&&e&&e.tHead&&t.tHead)for(const i of e.tHead.rows)for(const r of i.cells){const a=t.tHead.rows[i.rowIndex].cells[r.cellIndex];var l=window.getComputedStyle(r);let e=Number(r.getBoundingClientRect().width.toFixed(2));"content-box"===l.boxSizing&&(e-=parseFloat(l.paddingLeft),e-=parseFloat(l.paddingRight)),a.style.minWidth=e+"px",a.style.maxWidth=e+"px"}}_syncFixedTableWrapperWidth(){var e,t;this.fixedTableWrapperElement&&this.originalTableWrapperElement&&(e=this.fixedTableWrapperElement.getBoundingClientRect()["width"],t=this.originalTableWrapperElement.getBoundingClientRect()["width"],e!==t&&(this.fixedTableWrapperElement.style.width=t+"px"))}_syncHeadPosition(){if(this.fixedTableWrapperElement&&this.originalTableWrapperElement){let e="true"===this.fixedTableWrapperElement.dataset.isFixed;var t=this.fixedTableWrapperElement.getBoundingClientRect()["height"],{top:l,width:i,height:r}=this.originalTableWrapperElement.getBoundingClientRect(),a=2*t,n=(e?0:t)<=l,s=r+l-t<=0;e&&(n||s)?(this.fixedTableWrapperElement.style.position="",this.fixedTableWrapperElement.style.top="",this.fixedTableWrapperElement.style.zIndex="",this.fixedTableWrapperElement.style.width="",this.originalTableWrapperElement.style.paddingTop="",this.fixedTableWrapperElement.dataset.isFixed="false",e=!1):e||n||s||(this.fixedTableWrapperElement.style.position="fixed",this.fixedTableWrapperElement.style.top="0",this.fixedTableWrapperElement.style.zIndex="2",this.fixedTableWrapperElement.style.width=i+"px",this.originalTableWrapperElement.style.paddingTop=t+"px",this.fixedTableWrapperElement.dataset.isFixed="true",e=!0),this.fixedTableWrapperElement.style.transform=e&&r+l<a?`translate3d(0, ${r+l-a}px, 0)`:""}}_syncHorizontalScroll(e,t){e=e.scrollLeft;this.scrollLeft!==e&&(this.scrollLeft=e,t.scrollLeft=e)}_toggleHeadVisibility(e,t=!1){if(!e)throw new Error("<thead> is missing");const l=Array.from(e.rows);var i=l.map(e=>Array.from(e.cells));const r=[].concat(...i);e.style.visibility=t?"":"collapse",r.forEach(e=>{e.style.height=t?"":"0",e.style.paddingTop=t?"":"0",e.style.paddingBottom=t?"":"0",e.style.lineHeight=t?"":"0"})}_handleFixedTableWrapperScroll(e){this.fixedTableWrapperElement&&this.originalTableWrapperElement&&this._syncHorizontalScroll(this.fixedTableWrapperElement,this.originalTableWrapperElement)}_handleOriginalTableWrapperScroll(e){this.fixedTableWrapperElement&&this.originalTableWrapperElement&&this._syncHorizontalScroll(this.originalTableWrapperElement,this.fixedTableWrapperElement)}_handleWindowScroll(){this._syncHeadPosition()}_handleWindowResize(){this._syncColumnWidth(),this._syncFixedTableWrapperWidth()}_throttle(t,l=100){let i=null;return(...e)=>{null===i&&(i=setTimeout(()=>{t.apply(this,e),i=null},l))}}destroy(){var e,t,l;for(window.removeEventListener("scroll",this._handleWindowScrollThrottled,!1),window.removeEventListener("resize",this._handleWindowResizeThrottled),null!==(l=this.fixedTableWrapperElement)&&void 0!==l&&l.removeEventListener("scroll",this._handleFixedTableWrapperScrollThrottled,!1),null!==(l=this.originalTableWrapperElement)&&void 0!==l&&l.removeEventListener("scroll",this._handleOriginalTableWrapperScrollThrottled,!1);null!==(e=this.originalTableWrapperElement)&&void 0!==e&&e.firstChild;)null!==(e=this.wrapperElement)&&void 0!==e&&e.insertBefore(null===(e=this.originalTableWrapperElement)||void 0===e?void 0:e.firstChild,this.originalTableWrapperElement);for(;null!==(t=this.wrapperElement)&&void 0!==t&&t.firstChild;)null!==(t=this.wrapperElement.parentElement)&&void 0!==t&&t.insertBefore(null===(t=this.wrapperElement)||void 0===t?void 0:t.firstChild,this.wrapperElement);this.originalTableElement&&this.originalTableElement.tHead&&this._toggleHeadVisibility(this.originalTableElement.tHead,!0),null!==(l=this.fixedTableWrapperElement)&&void 0!==l&&l.remove(),null!==(l=this.originalTableWrapperElement)&&void 0!==l&&l.remove(),null!==(l=this.wrapperElement)&&void 0!==l&&l.remove(),delete this.originalTableElement,delete this.fixedTableWrapperElement,delete this.fixedTableElement,delete this.originalTableWrapperElement,delete this.wrapperElement,delete this.scrollLeft}}});
